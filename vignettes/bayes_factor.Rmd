---
title: "Bayes Factor"
author: "Richel J.C. Bilderbeek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Bayes Factor}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```
# Original code from R.S.Etienne
# Also at https://github.com/richelbilderbeek/raket_article/issues/10
load('d:/data/ms/microsnail_BEAST2_results_log_files.RData')
listname <- microsnail_BEAST2_results_log_files
lengthlist <- length(microsnail_BEAST2_results_log_files)
namei <- rep(0,lengthlist)
meanll <- rep(0,lengthlist)
harmmeanll <- rep(0,lengthlist)
for(i in 1:lengthlist)
{
   ll <- as.numeric(listname[[i]]$likelihood)
   minll <- min(ll)
   harmmeanll[i] <- log(length(ll)) + minll - sum(exp(-(ll - minll)))
   meanll[i] <- mean(ll)
   namei[i] <- names(listname)[i]
   namei[i] <- substr(namei[i],1,nchar(namei[i])-4)
}
BF <- rep(0,lengthlist)
for(i in 1:(lengthlist/2))
{
   BF[i] <- harmmeanll[i] - harmmeanll[lengthlist/2 + i]
}
for(i in (lengthlist/2 + 1):lengthlist)
{
   BF[i] <- harmmeanll[i] - harmmeanll[-lengthlist/2 + i]
}
summarytable <- data.frame(namei,meanll,harmmeanll,BF)
```
