---
title: "Setting a strict clock with a constant rate"
author: "Richel Bilderbeek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Setting a strict clock with a constant rate}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this vignette, I explore to set a fixed clock with
a known number of nucleotide substitutions.

```{r}
library(babette)
```

Note how I need to specify the clock rate twice:

```{r}
n_states <- 10
n_trees <- n_states * 0.8
out <- bbt_run(
  fasta_filenames = get_babette_path("anthus_aco.fas"),
  # fasta_filenames = get_babette_path("anthus_aco_sub.fas"),
  clock_models = create_strict_clock_model(
    clock_rate_param = create_clock_rate_param(
      value = 10.0, estimate = FALSE
    ),
    clock_rate_distr = create_normal_distr(
      mean = create_mean_param(
        value = 10.0, 
        estimate = FALSE
      ),
      sigma = create_sigma_param(
        value = 0.01, 
        estimate = FALSE
      )
    )
  ),
  mcmc = create_mcmc(
    chain_length = n_states * 1000, 
    store_every = 1000
  )
)
```

I expect the trees to have the same crown age:

```{r fig.width=7, fig.height=7}
plot_densitree(out$anthus_aco_trees[n_states-n_trees:n_trees], width = 5)
```
